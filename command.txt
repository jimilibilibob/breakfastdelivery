helm repo add elastic https://helm.elastic.co

RELEASE_NAME=practice
NAMESPACE=practice

kubectl create namespace $NAMESPACE

helm upgrade --install $RELEASE_NAME-elasticsearch elastic/elasticsearch \
 -f ./kubernetes/examples/elasticsearch-values.yaml \
--set clusterName=$RELEASE_NAME-elasticsearch \
--version 7.11.1 \
-n $NAMESPACE

helm upgrade --install $RELEASE_NAME-kibana elastic/kibana \
 -f ./kubernetes/examples/kibana-values.yaml \
--set elasticsearchHosts=http://$RELEASE_NAME-elasticsearch-master:9200 \
--version 7.11.1 \
-n $NAMESPACE

kubectl get all -n $NAMESPACE

helm upgrade --install -n $NAMESPACE kafka-$RELEASE_NAME bitnami/kafka --set externalAccess.enabled=true --set externalAccess.autoDiscovery.enabled=true --set rbac.create=true



kubectl patch nodepools.kube.cloud.ovh.com default-pool --type merge -p '{"spec":{"desiredNodes":0, "maxNodes":0, "minNodes":0}}'
kubectl patch nodepools.kube.cloud.ovh.com default-pool-2 --type merge -p '{"spec":{"desiredNodes":0, "maxNodes":0, "minNodes":0}}'

kubectl patch nodepools.kube.cloud.ovh.com default-pool --type merge -p '{"spec":{"desiredNodes":3, "maxNodes":4, "minNodes":1}}'